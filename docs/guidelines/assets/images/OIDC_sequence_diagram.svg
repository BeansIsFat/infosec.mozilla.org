<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1799" height="2074"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1799" height="2074"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="641.0199497809901" y="22.6179738" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authentication Sequence with OpenID Connect</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 88.511670804 L 247.7494395835156 2074.369770443999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 88.511670804 L 794.6816378423437 2074.369770443999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 88.511670804 L 1321.447179607031 2074.369770443999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.023579508203 88.511670804 L 1689.023579508203 2074.369770443999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 128.2724365003437 47.950104456000005 L 367.2264426666875 47.950104456000005 L 367.2264426666875 88.511670804 L 128.2724365003437 88.511670804 L 128.2724365003437 47.950104456000005 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="144.63277088234372" y="73.433021604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User's Browser (User-Agent)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 692.8713065121015 47.950104456000005 L 896.4919691725859 47.950104456000005 L 896.4919691725859 88.511670804 L 692.8713065121015 88.511670804 L 692.8713065121015 47.950104456000005 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="709.2316408941015" y="73.433021604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Website (Relying Party)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1235.6201780497381 47.950104456000005 L 1407.274181164324 47.950104456000005 L 1407.274181164324 88.511670804 L 1235.6201780497381 88.511670804 L 1235.6201780497381 47.950104456000005 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1251.9805124317381" y="73.433021604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OIDC Provider (OP)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1585.813246652082 47.950104456000005 L 1792.2339123643242 47.950104456000005 L 1792.2339123643242 88.511670804 L 1585.813246652082 88.511670804 L 1585.813246652082 47.950104456000005 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1602.173581034082" y="73.433021604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">LDAP, GitHub, etc. (IdP)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 104.08932765175781 118.668969204 L 377.8387672352734 118.668969204 L 391.4095515152734 132.239753484 L 391.4095515152734 153.34986236400002 L 104.08932765175781 153.34986236400002 L 104.08932765175781 118.668969204 M 377.8387672352734 118.668969204 L 377.8387672352734 132.239753484 L 391.4095515152734 132.239753484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="125.19943653175778" y="139.77907808400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User visits https://rp.example.net</text></g><g><g><rect fill="white" stroke="none" x="417.1037428588085" y="175.967836164" width="208.2235917082422" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="419.36554023880853" y="189.538620444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://rp.example.net/</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 195.57008012400001 L 792.1685296423436 195.57008012400001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,195.57008012400001) translate(-794.6816378423437,-195.57008012400001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.1160968423436 189.28730962400002 L 794.6816378423437 195.57008012400001 L 782.1160968423436 201.852850624 Z"/></g></g><g><g><rect fill="white" stroke="none" x="830.1359395917577" y="218.188053924" width="455.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="832.3977369717577" y="231.758838204" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://op.example.net/.well-known/openid-configuration</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 237.790297884 L 1318.934071407031 237.790297884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,237.790297884) translate(-1321.447179607031,-237.790297884)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1308.8816386070312 231.507527384 L 1321.447179607031 237.790297884 L 1308.8816386070312 244.073068384 Z"/></g></g><g><g><rect fill="white" stroke="none" x="957.8192815717382" y="260.408271684" width="200.49025430589845" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="960.0810789517382" y="273.97905596400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JSON meta-data document</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 280.010515644 L 797.1947460423437 280.010515644" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,280.010515644) translate(-794.6816378423437,-280.010515644)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 807.2471788423437 273.727745144 L 794.6816378423437 280.010515644 L 807.2471788423437 286.29328614400004 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 342.58690982400003 L 1313.907855007031 342.58690982400003 M 802.2209624423436 302.628489444 L 1300.3370707270312 302.628489444 L 1313.9078550070312 316.199273724 L 1313.9078550070312 382.54533020400004 L 802.2209624423436 382.54533020400004 L 802.2209624423436 302.628489444 M 1300.3370707270312 302.628489444 L 1300.3370707270312 316.199273724 L 1313.9078550070312 316.199273724" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="323.738598324" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JSON meta-data document:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="338.817247524" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"token_endpoint": "https://op.example.net/oauth/token", </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="353.89589672399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"authorization_endpoint":"https://op.example.net/authorize?...",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="368.9745459239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[...]}</text></g><g><g><rect fill="white" stroke="none" x="322.93707873527336" y="405.16330400400005" width="396.5569199553125" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="325.1988761152734" y="418.7340882840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Redirect to https://op.example.net/authorize?[...]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 424.76554796400006 L 250.2625477835156 424.76554796400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,424.76554796400006) translate(-247.7494395835156,-424.76554796400006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 418.48277746400004 L 247.7494395835156 424.76554796400006 L 260.3149805835156 431.0483184640001 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 509.959915944 L 787.1423132423437 509.959915944 M 255.28876418351558 447.383521764 L 773.5715289623437 447.383521764 L 787.1423132423437 460.954306044 L 787.1423132423437 572.536310124 L 255.28876418351558 572.536310124 L 255.28876418351558 447.383521764 M 773.5715289623437 447.383521764 L 773.5715289623437 460.954306044 L 787.1423132423437 460.954306044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="468.49363064400006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /authorize parameters:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="483.57227984400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">state=xxx (CSRF protection)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="498.650929044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">nonce=xxx (server-side replay protection)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="513.729578244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">scope=openid email profile</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="528.808227444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">redirect_uri=https://rp.example.net/callback (OP will redirect here)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="543.8868766439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">response_type=code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="276.39887306351557" y="558.9655258439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client_id=xxx (RP identifier)</text></g><g><g><rect fill="white" stroke="none" x="627.8031717611718" y="595.154283924" width="313.5902756682031" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="630.0649691411718" y="608.725068204" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://op.example.net/authorize?[...]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 614.756527884 L 1318.934071407031 614.756527884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,614.756527884) translate(-1321.447179607031,-614.756527884)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1308.8816386070312 608.473757384 L 1321.447179607031 614.756527884 L 1308.8816386070312 621.039298384 Z"/></g></g><g><g><rect fill="white" stroke="none" x="694.3865152670312" y="637.3745016839999" width="180.42358865648438" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="696.6483126470312" y="650.9452859639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Show hosted login page</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 656.976745644 L 250.2625477835156 656.976745644" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,656.976745644) translate(-247.7494395835156,-656.976745644)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 650.693975144 L 247.7494395835156 656.976745644 L 260.3149805835156 663.2595161439999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="729.5365129782128" y="679.5947194439999" width="110.12359323412109" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="731.7983103582128" y="693.1655037239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Performs login</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 699.1969634039999 L 1318.934071407031 699.1969634039999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,699.1969634039999) translate(-1321.447179607031,-699.1969634039999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1308.8816386070312 692.914192904 L 1321.447179607031 699.1969634039999 L 1308.8816386070312 705.4797339039999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1339.2902478270312" y="721.8149372039999" width="331.89026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1341.5520452070311" y="735.3857214839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authenticate user (via OIDC or other means)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 741.4171811639999 L 1686.510471308203 741.4171811639999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1689.023579508203,741.4171811639999) translate(-1689.023579508203,-741.4171811639999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1676.4580385082031 735.1344106639999 L 1689.023579508203 741.4171811639999 L 1676.4580385082031 747.6999516639999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1424.0402478270312" y="764.0351549639998" width="162.39026346117188" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1426.3020452070311" y="777.6059392439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return user attributes</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.023579508203 783.6373989239999 L 1323.9602878070311 783.6373989239999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,783.6373989239999) translate(-1321.447179607031,-783.6373989239999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1334.012720607031 777.3546284239999 L 1321.447179607031 783.6373989239999 L 1334.012720607031 789.9201694239998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="542.5698496176171" y="806.2553727239998" width="484.0569199553125" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="544.8316469976171" y="819.8261570039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Redirect to https://rp.example.net/callback?[...] (redirect_uri)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 825.8576166839998 L 250.2625477835156 825.8576166839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,825.8576166839998) translate(-247.7494395835156,-825.8576166839998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 819.5748461839999 L 247.7494395835156 825.8576166839998 L 260.3149805835156 832.1403871839998 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 880.8946862639998 L 787.1423132423437 880.8946862639998 M 550.9220954823437 848.4755904839998 L 773.5715289623437 848.4755904839998 L 787.1423132423437 862.0463747639998 L 787.1423132423437 913.3137820439998 L 550.9220954823437 913.3137820439998 L 550.9220954823437 848.4755904839998 M 773.5715289623437 848.4755904839998 L 773.5715289623437 862.0463747639998 L 787.1423132423437 862.0463747639998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="572.0322043623437" y="869.5856993639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /callback parameters:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="572.0322043623437" y="884.6643485639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">state=xxx</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="572.0322043623437" y="899.7429977639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">code=xxx</text></g><g><g><rect fill="white" stroke="none" x="370.43707873527336" y="935.9317558439998" width="301.5569199553125" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="372.6988761152734" y="949.5025401239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://rp.example.net/callback?[...]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 955.5339998039998 L 792.1685296423436 955.5339998039998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,955.5339998039998) translate(-794.6816378423437,-955.5339998039998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.1160968423436 949.2512293039998 L 794.6816378423437 955.5339998039998 L 782.1160968423436 961.8167703039998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="903.8192739423437" y="978.1519736039997" width="308.4902695646875" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="906.0810713223436" y="991.7227578839997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST https://op.example.net/oauth/token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 997.7542175639998 L 1318.934071407031 997.7542175639998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,997.7542175639998) translate(-1321.447179607031,-997.7542175639998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1308.8816386070312 991.4714470639998 L 1321.447179607031 997.7542175639998 L 1308.8816386070312 1004.0369880639997 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 1075.4092609439997 L 802.2209624423436 1075.4092609439997 M 802.2209624423436 1020.3721913639997 L 1231.5370524164844 1020.3721913639997 L 1245.1078366964844 1033.9429756439997 L 1245.1078366964844 1130.4463305239997 L 802.2209624423436 1130.4463305239997 L 802.2209624423436 1020.3721913639997 M 1231.5370524164844 1020.3721913639997 L 1231.5370524164844 1033.9429756439997 L 1245.1078366964844 1033.9429756439997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1041.4823002439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /oauth/token parameters:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1056.5609494439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client_id=xxx</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1071.6395986439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client_secret=xxx (secret identifying the RP to the OP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1086.7182478439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">grant_type=authorization_code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1101.7968970439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">code=xxx</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1116.8755462439995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">state=xxx</text></g><g><g><rect fill="white" stroke="none" x="883.9526052411718" y="1153.0643043239997" width="348.22360696703123" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="886.2144026211718" y="1166.6350886039997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JSON {"base64(id_token)", "access_token", ...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 1172.6665482839996 L 797.1947460423437 1172.6665482839996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,1172.6665482839996) translate(-794.6816378423437,-1172.6665482839996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 807.2471788423437 1166.3837777839997 L 794.6816378423437 1172.6665482839996 L 807.2471788423437 1178.9493187839996 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 1280.4788900639999 L 802.2209624423436 1280.4788900639999 M 802.2209624423436 1195.2845220839997 L 1105.1703837153125 1195.2845220839997 L 1118.7411679953125 1208.8553063639997 L 1118.7411679953125 1365.6732580439998 L 802.2209624423436 1365.6732580439998 L 802.2209624423436 1195.2845220839997 M 1105.1703837153125 1195.2845220839997 L 1105.1703837153125 1208.8553063639997 L 1118.7411679953125 1208.8553063639997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1216.3946309639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JSON Document:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1231.4732801639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1246.5519293639998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1261.6305785639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "id_token": ADNqVMtqKeYp5w==...,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1276.7092277639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "access_token": xxx,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1291.7878769639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "email": "test@rp.example.net,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1306.8665261639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "attribute1": ...,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1321.9451753639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "attribute2": ...,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1337.0238245639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   [...]</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.3310713223436" y="1352.1024737639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">}</text></g><g><g><rect fill="white" stroke="none" x="812.5247060623437" y="1388.2912318439999" width="348.0902756682031" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="814.7865034423437" y="1401.8620161239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verify id_token signature is valid, signed by OP</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 1407.893475804 L 854.9962346423437 1407.893475804 L 854.9962346423437 1427.495719764 L 797.1947460423437 1427.495719764" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,1427.495719764) translate(-794.6816378423437,-1427.495719764)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 807.2471788423437 1421.212949264 L 794.6816378423437 1427.495719764 L 807.2471788423437 1433.7784902639999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="385.3204100341015" y="1450.113693564" width="271.79025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="387.5822074141015" y="1463.684477844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Redirect https://rp.example.net/</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 1469.7159375239999 L 250.2625477835156 1469.7159375239999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,1469.7159375239999) translate(-247.7494395835156,-1469.7159375239999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 1463.4331670239999 L 247.7494395835156 1469.7159375239999 L 260.3149805835156 1475.9987080239998 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 53.77266200234375 1492.3339113239997 L 428.15543288468746 1492.3339113239997 L 441.72621716468745 1505.9046956039997 L 441.72621716468745 1527.0148044839998 L 53.77266200234375 1527.0148044839998 L 53.77266200234375 1492.3339113239997 M 428.15543288468746 1492.3339113239997 L 428.15543288468746 1505.9046956039997 L 441.72621716468745 1505.9046956039997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="74.88277088234372" y="1513.4440202039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User is authenticated to https://rp.example.net</text></g><g><g><rect fill="white" stroke="none" x="417.1037428588085" y="1549.6327782839999" width="208.2235917082422" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="419.36554023880853" y="1563.2035625639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://rp.example.net/</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 1569.2350222439998 L 792.1685296423436 1569.2350222439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,1569.2350222439998) translate(-794.6816378423437,-1569.2350222439998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.1160968423436 1562.9522517439998 L 794.6816378423437 1569.2350222439998 L 782.1160968423436 1575.5177927439997 Z"/></g></g><g><g><rect fill="white" stroke="none" x="390.80374743644524" y="1591.8529960439998" width="260.82358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="393.06554481644525" y="1605.4237803239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">rp.example.net's page is displayed</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 1611.4552400039997 L 250.2625477835156 1611.4552400039997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,1611.4552400039997) translate(-247.7494395835156,-1611.4552400039997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 1605.1724695039998 L 247.7494395835156 1611.4552400039997 L 260.3149805835156 1617.7380105039997 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 1646.3874439839997 L 1791.4606754 1646.3874439839997 M 7.5393246000000005 1651.4136603839997 L 1791.4606754 1651.4136603839997 M 7.5393246000000005 1656.4398767839998 L 1791.4606754 1656.4398767839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 715.0232224188281 1634.0732138039996 L 1083.976777581172 1634.0732138039996 L 1083.976777581172 1668.7541069639997 L 715.0232224188281 1668.7541069639997 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="736.1333312988281" y="1655.1833226839997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> 15 minutes later... (session require refresh) </text></g><g><g><rect fill="white" stroke="none" x="417.1037428588085" y="1691.3720807639997" width="208.2235917082422" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="419.36554023880853" y="1704.9428650439997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://rp.example.net/</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 1710.9743247239996 L 792.1685296423436 1710.9743247239996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(794.6816378423437,1710.9743247239996) translate(-794.6816378423437,-1710.9743247239996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.1160968423436 1704.6915542239997 L 794.6816378423437 1710.9743247239996 L 782.1160968423436 1717.2570952239996 Z"/></g></g><g><g><rect fill="white" stroke="none" x="266.03706576530266" y="1733.5922985239997" width="510.3569458952539" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="268.2988631453027" y="1747.1630828039997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Redirect to https://op.example.net/authorize?</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="634.8655440535058" y="1747.1630828039997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prompt=none</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="748.6655471052636" y="1747.1630828039997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[...]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 1753.1945424839996 L 250.2625477835156 1753.1945424839996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,1753.1945424839996) translate(-247.7494395835156,-1753.1945424839996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 1746.9117719839996 L 247.7494395835156 1753.1945424839996 L 260.3149805835156 1759.4773129839996 Z"/></g></g><g><g><rect fill="white" stroke="none" x="570.9031740499902" y="1775.8125162839997" width="427.3902710905664" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="573.1649714299901" y="1789.3833005639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https://op.example.net/authorize?</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="856.7649775335058" y="1789.3833005639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prompt=none</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="970.5649805852636" y="1789.3833005639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[...]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 247.7494395835156 1795.4147602439996 L 1318.934071407031 1795.4147602439996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,1795.4147602439996) translate(-1321.447179607031,-1795.4147602439996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1308.8816386070312 1789.1319897439996 L 1321.447179607031 1795.4147602439996 L 1308.8816386070312 1801.6975307439996 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1399.2902478270312" y="1818.0327340439997" width="211.89026346117188" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1401.5520452070311" y="1831.6035183239997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">silently re-authenticate user</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 1837.6349780039995 L 1686.510471308203 1837.6349780039995" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1689.023579508203,1837.6349780039995) translate(-1689.023579508203,-1837.6349780039995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1676.4580385082031 1831.3522075039996 L 1689.023579508203 1837.6349780039995 L 1676.4580385082031 1843.9177485039995 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1377.6069134764452" y="1860.2529518039996" width="255.25693216234376" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1379.8687108564452" y="1873.8237360839996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return new/current user attributes</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.023579508203 1879.8551957639995 L 1323.9602878070311 1879.8551957639995" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1321.447179607031,1879.8551957639995) translate(-1321.447179607031,-1879.8551957639995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1334.012720607031 1873.5724252639995 L 1321.447179607031 1879.8551957639995 L 1334.012720607031 1886.1379662639995 Z"/></g></g><g><g><rect fill="white" stroke="none" x="542.5698496176171" y="1902.4731695639996" width="484.0569199553125" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="544.8316469976171" y="1916.0439538439996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Redirect to https://rp.example.net/callback?[...] (redirect_uri)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1321.447179607031 1922.0754135239995 L 250.2625477835156 1922.0754135239995" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,1922.0754135239995) translate(-247.7494395835156,-1922.0754135239995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 1915.7926430239995 L 247.7494395835156 1922.0754135239995 L 260.3149805835156 1928.3581840239995 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 1944.6933873239993 L 474.3887702870312 1944.6933873239993 L 487.9595545670312 1958.2641716039993 L 487.9595545670312 1979.3742804839994 L 7.5393246000000005 1979.3742804839994 L 7.5393246000000005 1944.6933873239993 M 474.3887702870312 1944.6933873239993 L 474.3887702870312 1958.2641716039993 L 487.9595545670312 1958.2641716039993" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="1965.8034962039994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User session, expiration and profile attributes are refreshed</text></g><g><g><rect fill="white" stroke="none" x="390.80374743644524" y="2001.9922542839995" width="260.82358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="393.06554481644525" y="2015.5630385639995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">rp.example.net's page is displayed</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 794.6816378423437 2021.5944982439994 L 250.2625477835156 2021.5944982439994" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(247.7494395835156,2021.5944982439994) translate(-247.7494395835156,-2021.5944982439994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 260.3149805835156 2015.3117277439994 L 247.7494395835156 2021.5944982439994 L 260.3149805835156 2027.8772687439994 Z"/></g></g></g></g></svg>